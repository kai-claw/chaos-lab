const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/BifurcationDiagram-BwwQLxQF.js","assets/three-vendor-CMdyc2H8.js","assets/BifurcationDiagram-7MOkXOt8.css","assets/PoincareSection-CcWwMgsW.js","assets/PoincareSection-Bu5ajD9c.css","assets/ParameterSpace-BtBtlbfb.js","assets/ParameterSpace-U0tBLzM4.css"])))=>i.map(i=>d[i]);
import{V as L,c as He,r as l,u as q,B as Q,L as Pe,A as ee,j as e,a as we,D as Ge,C as W,b as Re,d as Ve,E as Ue,e as We,G as Ye,O as Ke,f as Xe,w as Ze,_ as ge,g as Je}from"./three-vendor-CMdyc2H8.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function s(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(o){if(o.ep)return;o.ep=!0;const r=s(o);fetch(o.href,r)}})();class Qe{points=[];position;params;dt=.01;perturbation=new L(1,0,0);lyapunovSum=0;lyapunovSteps=0;lyapunovExponent=0;RENORM_INTERVAL=10;stepsSinceRenorm=0;prevZ=0;prevDz=0;poincarePoints=[];MAX_POINCARE=5e3;constructor(t=new L(1,1,1),s){this.position=t.clone(),this.params=s,this.points=[this.position.clone()],this.prevZ=t.z}derivatives(t,s,a){const{sigma:o,rho:r,beta:i}=this.params;return[o*(s-t),t*(r-a)-s,t*s-i*a]}jacobianApply(t,s,a,o,r,i){const{sigma:h,rho:u,beta:c}=this.params;return[h*(r-o),(u-a)*o-r-t*i,s*o+t*r-c*i]}step(t=1){const s=this.dt*t,{x:a,y:o,z:r}=this.position,[i,h,u]=this.derivatives(a,o,r),[c,p,m]=this.derivatives(a+.5*s*i,o+.5*s*h,r+.5*s*u),[f,d,g]=this.derivatives(a+.5*s*c,o+.5*s*p,r+.5*s*m),[R,x,y]=this.derivatives(a+s*f,o+s*d,r+s*g);this.position.x+=s/6*(i+2*c+2*f+R),this.position.y+=s/6*(h+2*p+2*d+x),this.position.z+=s/6*(u+2*m+2*g+y),(!isFinite(this.position.x)||!isFinite(this.position.y)||!isFinite(this.position.z)||Math.abs(this.position.x)>1e6)&&this.position.set(1,1,1),this.points.push(this.position.clone());const P=this.perturbation.x,E=this.perturbation.y,T=this.perturbation.z,[C,j,k]=this.jacobianApply(this.position.x,this.position.y,this.position.z,P,E,T);if(this.perturbation.x+=C*s,this.perturbation.y+=j*s,this.perturbation.z+=k*s,this.stepsSinceRenorm++,this.stepsSinceRenorm>=this.RENORM_INTERVAL){const S=this.perturbation.length();if(S>0&&isFinite(S)){this.lyapunovSum+=Math.log(S),this.lyapunovSteps++,this.perturbation.divideScalar(S);const w=this.lyapunovSteps*this.RENORM_INTERVAL*this.dt;this.lyapunovExponent=this.lyapunovSum/w}this.stepsSinceRenorm=0}const v=this.position.z-this.prevZ;return this.prevDz>0&&v<=0&&this.points.length>100&&(this.poincarePoints.push([this.position.x,this.position.y]),this.poincarePoints.length>this.MAX_POINCARE&&this.poincarePoints.splice(0,this.poincarePoints.length-this.MAX_POINCARE)),this.prevDz=v,this.prevZ=this.position.z,this.position.clone()}reset(t=new L(1,1,1)){this.position=t.clone(),this.points=[this.position.clone()],this.perturbation.set(1,0,0),this.lyapunovSum=0,this.lyapunovSteps=0,this.lyapunovExponent=0,this.stepsSinceRenorm=0,this.prevZ=t.z,this.prevDz=0,this.poincarePoints=[]}updateParams(t){this.params={...this.params,...t}}trimTrail(t){this.points.length>t&&this.points.splice(0,this.points.length-t)}getSpeed(){if(this.points.length<2)return 0;const t=this.points[this.points.length-1],s=this.points[this.points.length-2];return t.distanceTo(s)}getParams(){return{...this.params}}}const I={classic:{bg:"#000010",bgRgb:"0,0,16",panelBg:"rgba(20, 20, 25, 0.95)",panelBorder:"rgba(255, 255, 255, 0.1)",text:"#cccccc",textMuted:"rgba(255,255,255,0.6)",accent:"#88ccff",accent2:"#aaffaa",heading:"#88ccff",paramColor:"#ffcc88",trailHue1:.55,trailHue2:.85,starColor:"#ffffff"},neon:{bg:"#000000",bgRgb:"0,0,0",panelBg:"rgba(10, 0, 20, 0.95)",panelBorder:"rgba(255, 0, 255, 0.25)",text:"#e0e0e0",textMuted:"rgba(255,255,255,0.5)",accent:"#ff00ff",accent2:"#00ffff",heading:"#ff44ff",paramColor:"#ffff00",trailHue1:.83,trailHue2:.5,starColor:"#ff88ff"},blueprint:{bg:"#0a1628",bgRgb:"10,22,40",panelBg:"rgba(15, 30, 60, 0.95)",panelBorder:"rgba(100, 160, 255, 0.3)",text:"#c0d8f0",textMuted:"rgba(192,216,240,0.6)",accent:"#4488ff",accent2:"#88bbff",heading:"#6699ff",paramColor:"#aaccff",trailHue1:.6,trailHue2:.58,starColor:"#4488ff"},terminal:{bg:"#000a00",bgRgb:"0,10,0",panelBg:"rgba(0, 15, 0, 0.95)",panelBorder:"rgba(0, 255, 0, 0.2)",text:"#00dd00",textMuted:"rgba(0,220,0,0.5)",accent:"#00ff00",accent2:"#88ff88",heading:"#00ff00",paramColor:"#44ff44",trailHue1:.33,trailHue2:.28,starColor:"#00ff00"}},Te={lorenz:[{name:"Classic Lorenz",description:"The original butterfly attractor",params:{sigma:10,rho:28,beta:8/3}},{name:"Edge of Chaos",description:"Parameters at the edge between order and chaos",params:{sigma:10,rho:24,beta:8/3}},{name:"Strange Attractor",description:"Different parameter set creating unique patterns",params:{sigma:12,rho:30,beta:2.5}}],rossler:[{name:"Classic RÃ¶ssler",description:"The standard RÃ¶ssler attractor parameters",params:{a:.2,b:.2,c:5.7}},{name:"Spiral Focus",description:"Creates tighter spiral patterns",params:{a:.1,b:.1,c:4}},{name:"Period Doubling",description:"Shows period-doubling route to chaos",params:{a:.15,b:.2,c:10}}],doublePendulum:[{name:"Equal Masses",description:"Two pendulums with equal mass and length",params:{mass1:1,mass2:1,length1:1,length2:1,gravity:9.81,damping:0}},{name:"Heavy Bottom",description:"Bottom pendulum twice as heavy",params:{mass1:1,mass2:2,length1:1,length2:1,gravity:9.81,damping:0}},{name:"With Damping",description:"Small damping showing energy dissipation",params:{mass1:1,mass2:1,length1:1,length2:1,gravity:9.81,damping:.05}}]},X=[{name:"The Butterfly Effect",emoji:"ðŸ¦‹",description:"Two nearly identical universes diverge into completely different futures",system:"lorenz",params:{sigma:10,rho:28,beta:8/3},trailLength:2e3,speed:1,sideBySide:!0,offset:1e-6},{name:"The Strange Attractor",emoji:"ðŸŒ€",description:"The iconic Lorenz butterfly â€” a shape that never repeats, yet never escapes",system:"lorenz",params:{sigma:10,rho:28,beta:8/3},trailLength:4e3,speed:1.5,sideBySide:!1,offset:.001},{name:"Edge of Order",emoji:"âš–ï¸",description:"Right at the boundary where predictable behavior gives way to chaos",system:"lorenz",params:{sigma:10,rho:24.5,beta:8/3},trailLength:3e3,speed:.8,sideBySide:!1,offset:.001},{name:"The Spiral",emoji:"ðŸŒŠ",description:"The RÃ¶ssler attractor â€” simplicity breeds complexity in this elegant spiral",system:"rossler",params:{a:.2,b:.2,c:5.7},trailLength:3500,speed:1.2,sideBySide:!1,offset:.001},{name:"Period Doubling",emoji:"ðŸ”„",description:"Watch the RÃ¶ssler system trace a period-2 orbit â€” the route to chaos begins",system:"rossler",params:{a:.2,b:.2,c:3.5},trailLength:3e3,speed:1,sideBySide:!1,offset:.001},{name:"The Pendulum",emoji:"âš¡",description:"A simple double pendulum â€” deterministic laws, unpredictable motion",system:"doublePendulum",params:{mass1:1,mass2:1,length1:1,length2:1,gravity:9.81,damping:0},trailLength:2e3,speed:1,sideBySide:!1,offset:.001},{name:"Dual Pendulums",emoji:"ðŸ”€",description:"Two pendulums, almost identical â€” watch them dance apart",system:"doublePendulum",params:{mass1:1,mass2:1,length1:1,length2:1,gravity:9.81,damping:0},trailLength:1500,speed:1,sideBySide:!0,offset:1e-4}],z=He(n=>({currentSystem:"lorenz",setCurrentSystem:t=>n({currentSystem:t}),isPlaying:!0,setIsPlaying:t=>n({isPlaying:t}),speed:1,setSpeed:t=>n({speed:t}),trailLength:2e3,setTrailLength:t=>n({trailLength:t}),sideBySideMode:!1,setSideBySideMode:t=>n({sideBySideMode:t}),initialOffset:.001,setInitialOffset:t=>n({initialOffset:t}),divergence:0,setDivergence:t=>n({divergence:t}),colorTheme:"classic",setColorTheme:t=>n({colorTheme:t}),lorenzParams:{sigma:10,rho:28,beta:8/3},setLorenzParams:t=>n(s=>({lorenzParams:{...s.lorenzParams,...t}})),rosslerParams:{a:.2,b:.2,c:5.7},setRosslerParams:t=>n(s=>({rosslerParams:{...s.rosslerParams,...t}})),doublePendulumParams:{mass1:1,mass2:1,length1:1,length2:1,gravity:9.81,damping:0},setDoublePendulumParams:t=>n(s=>({doublePendulumParams:{...s.doublePendulumParams,...t}})),currentPreset:null,setCurrentPreset:t=>n({currentPreset:t}),showInfoPanel:!0,setShowInfoPanel:t=>n({showInfoPanel:t}),autoRotate:!0,setAutoRotate:t=>n({autoRotate:t}),_resetCounter:0,resetSimulation:()=>{n(t=>({_resetCounter:t._resetCounter+1,isPlaying:!1})),setTimeout(()=>n({isPlaying:!0}),100)},showPerformanceWarning:!1,setShowPerformanceWarning:t=>n({showPerformanceWarning:t}),showLyapunov:!1,setShowLyapunov:t=>n({showLyapunov:t}),lyapunovExponent:0,setLyapunovExponent:t=>n({lyapunovExponent:t}),showBifurcation:!1,setShowBifurcation:t=>n({showBifurcation:t}),showPoincare:!1,setShowPoincare:t=>n({showPoincare:t}),showParameterSpace:!1,setShowParameterSpace:t=>n({showParameterSpace:t}),cinematicCamera:!1,setCinematicCamera:t=>n({cinematicCamera:t}),chaosAutopilot:!1,setChaosAutopilot:t=>n({chaosAutopilot:t}),storyMode:!1,setStoryMode:t=>n({storyMode:t}),currentStoryIndex:0,setCurrentStoryIndex:t=>n({currentStoryIndex:t}),bloomEnabled:!0,setBloomEnabled:t=>n({bloomEnabled:t}),bloomIntensity:1.5,setBloomIntensity:t=>n({bloomIntensity:t}),audioEnabled:!1,setAudioEnabled:t=>n({audioEnabled:t}),audioVolume:.3,setAudioVolume:t=>n({audioVolume:t})})),G={system:null,type:null};function ye(n,t){G.system=n,G.type=t}function be(n){G.system===n&&(G.system=null,G.type=null)}const Y=6e3,xe=({points:n,hueStart:t,hueEnd:s,scale:a=1,flatZ:o=!1,glowIntensity:r=.6})=>{const i=l.useRef(null),h=l.useRef(null),u=l.useRef(null),c=l.useRef(null),{posBuffer:p,colorBuffer:m,glowColorBuffer:f}=l.useMemo(()=>({posBuffer:new Float32Array(Y*3),colorBuffer:new Float32Array(Y*3),glowColorBuffer:new Float32Array(Y*3)}),[]);q(()=>{if(!u.current||!c.current)return;const R=Math.min(n.length,Y);if(R<2){u.current.setDrawRange(0,0),c.current.setDrawRange(0,0);return}const x=Math.max(0,n.length-Y),y=a;for(let j=0;j<R;j++){const k=n[x+j],v=j*3;p[v]=k.x*y,p[v+1]=k.y*y,p[v+2]=o?0:k.z*y;const S=j/(R-1),w=S*S,A=t+(s-t)*S,N=.8+S*.2,M=.3+w*.55,B=(1-Math.abs(2*M-1))*N,D=(A%1+1)%1*6,F=B*(1-Math.abs(D%2-1)),_=M-B/2,se=Math.floor(D)%6;let $=0,V=0,O=0;switch(se){case 0:$=B,V=F;break;case 1:$=F,V=B;break;case 2:V=B,O=F;break;case 3:V=F,O=B;break;case 4:$=F,O=B;break;case 5:$=B,O=F;break}m[v]=($+_)*w,m[v+1]=(V+_)*w,m[v+2]=(O+_)*w;const te=w*r,H=1.5+S*.5;f[v]=($+_)*te*H,f[v+1]=(V+_)*te*H,f[v+2]=(O+_)*te*H}const P=u.current.getAttribute("position"),E=u.current.getAttribute("color");P.set(p.subarray(0,R*3)),E.set(m.subarray(0,R*3)),P.needsUpdate=!0,E.needsUpdate=!0,u.current.setDrawRange(0,R);const T=c.current.getAttribute("position"),C=c.current.getAttribute("color");T.set(p.subarray(0,R*3)),C.set(f.subarray(0,R*3)),T.needsUpdate=!0,C.needsUpdate=!0,c.current.setDrawRange(0,R)}),l.useEffect(()=>{!u.current||!c.current||(u.current.setAttribute("position",new Q(new Float32Array(Y*3),3)),u.current.setAttribute("color",new Q(new Float32Array(Y*3),3)),u.current.setDrawRange(0,0),c.current.setAttribute("position",new Q(new Float32Array(Y*3),3)),c.current.setAttribute("color",new Q(new Float32Array(Y*3),3)),c.current.setDrawRange(0,0))},[]);const d=l.useMemo(()=>new Pe({vertexColors:!0,transparent:!0,opacity:1,depthWrite:!1,blending:ee}),[]),g=l.useMemo(()=>new Pe({vertexColors:!0,transparent:!0,opacity:.5,depthWrite:!1,blending:ee}),[]);return e.jsxs(e.Fragment,{children:[e.jsxs("primitive",{object:new we,ref:i,children:[e.jsx("bufferGeometry",{ref:u}),e.jsx("primitive",{object:d,attach:"material"})]}),e.jsxs("primitive",{object:new we,ref:h,children:[e.jsx("bufferGeometry",{ref:c}),e.jsx("primitive",{object:g,attach:"material"})]})]})},ve=({position:n,color:t,lightIntensity:s=.8,size:a=1,showPulse:o=!0})=>{const r=l.useRef(null),i=l.useRef(null),h=l.useRef(null),u=l.useRef(Math.random()*Math.PI*2),c=l.useMemo(()=>{const p=t.clone();return p.offsetHSL(0,.1,.2),p},[t]);return q(({clock:p})=>{const m=p.getElapsedTime();if(u.current+=.04,i.current){const f=1+Math.sin(m*3)*.15,d=.05*a*f;i.current.scale.setScalar(d/(.05*a)||1)}if(h.current){const f=1+Math.sin(m*3+Math.PI)*.2,d=h.current.material;d.opacity=.15+Math.sin(m*2.5)*.08;const g=.12*a*f;h.current.scale.setScalar(g/(.12*a)||1)}if(r.current&&o){const f=m*1.2%2,d=.05+f*.15*a;r.current.scale.set(d,d,1);const g=r.current.material;g.opacity=Math.max(0,.4*(1-f/2))}}),e.jsxs("group",{position:n,children:[s>0&&e.jsx("pointLight",{color:t,intensity:s*.4,distance:1.5*a,decay:2}),e.jsxs("mesh",{ref:h,children:[e.jsx("sphereGeometry",{args:[.12*a,16,16]}),e.jsx("meshBasicMaterial",{color:t,transparent:!0,opacity:.15,depthWrite:!1,blending:ee})]}),e.jsxs("mesh",{ref:i,children:[e.jsx("sphereGeometry",{args:[.05*a,16,16]}),e.jsx("meshBasicMaterial",{color:c,transparent:!0,opacity:.95})]}),o&&e.jsxs("mesh",{ref:r,rotation:[Math.PI/2,0,0],children:[e.jsx("ringGeometry",{args:[.8,1,32]}),e.jsx("meshBasicMaterial",{color:t,transparent:!0,opacity:.3,side:Ge,depthWrite:!1,blending:ee})]})]})},et=({position:n=[0,0,0],scale:t=.1,initialCondition:s=[1,1,1],isSecondary:a=!1,lastPosRef:o})=>{const r=l.useRef(null),{isPlaying:i,speed:h,trailLength:u,lorenzParams:c,_resetCounter:p,colorTheme:m,showLyapunov:f,setLyapunovExponent:d,showPoincare:g}=z(),R=I[m],x=l.useMemo(()=>{const j=new L(...s);return new Qe(j,c)},[s[0],s[1],s[2],c.sigma,c.rho,c.beta]);l.useEffect(()=>{x.reset(new L(...s))},[p]),l.useEffect(()=>{x.updateParams(c)},[c,x]);const y=l.useRef(x);y.current=x,l.useEffect(()=>(a||ye(x,"lorenz"),()=>{a||be(x)}),[x,a]);const P=l.useRef(0);q(()=>{if(!i)return;x.step(h*.5),x.trimTrail(u);const j=x.points;if(o&&j.length>0){const k=j[j.length-1];o.current=k.clone()}!a&&(f||g)&&(P.current++,P.current%30===0&&d(x.lyapunovExponent))});const E=a?R.trailHue2:R.trailHue1,T=E+.2,C=new W().setHSL(E+.15,1,.7);return e.jsxs("group",{ref:r,position:n,children:[e.jsx(xe,{points:x.points,hueStart:E,hueEnd:T,lineWidth:2.5,glowIntensity:.5,scale:t}),x.points.length>0&&(()=>{const j=x.points[x.points.length-1];return e.jsx(ve,{position:[j.x*t,j.y*t,j.z*t],color:C,lightIntensity:a?.4:.8,size:.8,showPulse:!a})})()]})};class tt{points=[];position;params;dt=.01;perturbation=new L(1,0,0);lyapunovSum=0;lyapunovSteps=0;lyapunovExponent=0;RENORM_INTERVAL=10;stepsSinceRenorm=0;prevY=0;poincarePoints=[];MAX_POINCARE=5e3;constructor(t=new L(1,1,1),s){this.position=t.clone(),this.params=s,this.points=[this.position.clone()],this.prevY=t.y}derivatives(t,s,a){const{a:o,b:r,c:i}=this.params;return[-s-a,t+o*s,r+a*(t-i)]}jacobianApply(t,s,a,o,r,i){const{a:h,c:u}=this.params;return[-r-i,o+h*r,a*o+(t-u)*i]}step(t=1){const s=this.dt*t,{x:a,y:o,z:r}=this.position,[i,h,u]=this.derivatives(a,o,r),[c,p,m]=this.derivatives(a+.5*s*i,o+.5*s*h,r+.5*s*u),[f,d,g]=this.derivatives(a+.5*s*c,o+.5*s*p,r+.5*s*m),[R,x,y]=this.derivatives(a+s*f,o+s*d,r+s*g);this.position.x+=s/6*(i+2*c+2*f+R),this.position.y+=s/6*(h+2*p+2*d+x),this.position.z+=s/6*(u+2*m+2*g+y),(!isFinite(this.position.x)||!isFinite(this.position.y)||!isFinite(this.position.z)||Math.abs(this.position.x)>1e6)&&this.position.set(1,1,1),this.points.push(this.position.clone());const P=this.perturbation.x,E=this.perturbation.y,T=this.perturbation.z,[C,j,k]=this.jacobianApply(this.position.x,this.position.y,this.position.z,P,E,T);if(this.perturbation.x+=C*s,this.perturbation.y+=j*s,this.perturbation.z+=k*s,this.stepsSinceRenorm++,this.stepsSinceRenorm>=this.RENORM_INTERVAL){const v=this.perturbation.length();if(v>0&&isFinite(v)){this.lyapunovSum+=Math.log(v),this.lyapunovSteps++,this.perturbation.divideScalar(v);const S=this.lyapunovSteps*this.RENORM_INTERVAL*this.dt;this.lyapunovExponent=this.lyapunovSum/S}this.stepsSinceRenorm=0}return this.prevY<0&&this.position.y>=0&&this.points.length>100&&(this.poincarePoints.push([this.position.x,this.position.z]),this.poincarePoints.length>this.MAX_POINCARE&&this.poincarePoints.splice(0,this.poincarePoints.length-this.MAX_POINCARE)),this.prevY=this.position.y,this.position.clone()}reset(t=new L(1,1,1)){this.position=t.clone(),this.points=[this.position.clone()],this.perturbation.set(1,0,0),this.lyapunovSum=0,this.lyapunovSteps=0,this.lyapunovExponent=0,this.stepsSinceRenorm=0,this.prevY=t.y,this.poincarePoints=[]}updateParams(t){this.params={...this.params,...t}}trimTrail(t){this.points.length>t&&this.points.splice(0,this.points.length-t)}getSpeed(){if(this.points.length<2)return 0;const t=this.points[this.points.length-1],s=this.points[this.points.length-2];return t.distanceTo(s)}getParams(){return{...this.params}}}const st=({position:n=[0,0,0],scale:t=.5,initialCondition:s=[1,1,1],isSecondary:a=!1,lastPosRef:o})=>{const r=l.useRef(null),{isPlaying:i,speed:h,trailLength:u,rosslerParams:c,_resetCounter:p,colorTheme:m,showLyapunov:f,setLyapunovExponent:d,showPoincare:g,currentSystem:R}=z(),x=I[m],y=l.useMemo(()=>{const j=new L(...s);return new tt(j,c)},[s[0],s[1],s[2],c.a,c.b,c.c]);l.useEffect(()=>{y.reset(new L(...s))},[p]),l.useEffect(()=>{y.updateParams(c)},[c,y]),l.useEffect(()=>(a||ye(y,"rossler"),()=>{a||be(y)}),[y,a]);const P=l.useRef(0);q(()=>{if(!i)return;y.step(h*.5),y.trimTrail(u);const j=y.points;if(o&&j.length>0){const k=j[j.length-1];o.current=k.clone()}!a&&R==="rossler"&&(f||g)&&(P.current++,P.current%30===0&&d(y.lyapunovExponent))});const E=a?x.trailHue2:x.trailHue1,T=E+.25,C=new W().setHSL(E+.15,1,.8);return e.jsxs("group",{ref:r,position:n,children:[e.jsx(xe,{points:y.points,hueStart:E,hueEnd:T,lineWidth:2.5,glowIntensity:.5,scale:t}),y.points.length>0&&(()=>{const j=y.points[y.points.length-1];return e.jsx(ve,{position:[j.x*t,j.y*t,j.z*t],color:C,lightIntensity:a?.5:1,size:1,showPulse:!a})})()]})};class at{points=[];positions=[];state;params;dt=.005;pertState={theta1:1e-6,theta2:0,omega1:0,omega2:0};lyapunovSum=0;lyapunovSteps=0;lyapunovExponent=0;RENORM_INTERVAL=20;stepsSinceRenorm=0;prevTheta2=0;poincarePoints=[];MAX_POINCARE=5e3;constructor(t={theta1:Math.PI/2,theta2:Math.PI/2,omega1:0,omega2:0},s){this.state={...t},this.params=s,this.prevTheta2=t.theta2;const a=this.calculatePositions();this.positions=[a],this.points=[new L(a.p2.x,a.p2.y,0)]}calculatePositions(){const{length1:t,length2:s}=this.params,{theta1:a,theta2:o}=this.state,r=new Re(t*Math.sin(a),-t*Math.cos(a)),i=new Re(r.x+s*Math.sin(o),r.y-s*Math.cos(o));return{p1:r,p2:i}}accelerations(t){const{mass1:s,mass2:a,length1:o,length2:r,gravity:i,damping:h}=this.params,{theta1:u,theta2:c,omega1:p,omega2:m}=t,f=s,d=a,g=o,R=r,x=i,y=Math.cos(u-c),P=Math.sin(u-c),E=Math.sin(u),T=Math.sin(c),C=(f+d)*g-d*g*y*y,j=R/g*C,k=-d*g*p*p*P*y+d*x*T*y+d*R*m*m*P-(f+d)*x*E,v=-d*R*m*m*P*y+(f+d)*x*E*y+(f+d)*g*p*p*P-(f+d)*x*T;let S=k/C,w=v/j;return S-=h*p,w-=h*m,{alpha1:S,alpha2:w}}stateDerivative(t){const{alpha1:s,alpha2:a}=this.accelerations(t);return{theta1:t.omega1,theta2:t.omega2,omega1:s,omega2:a}}addStates(t,s,a){return{theta1:t.theta1+s.theta1*a,theta2:t.theta2+s.theta2*a,omega1:t.omega1+s.omega1*a,omega2:t.omega2+s.omega2*a}}step(t=1){const s=this.dt*t,a=this.stateDerivative(this.state),o=this.stateDerivative(this.addStates(this.state,a,.5*s)),r=this.stateDerivative(this.addStates(this.state,o,.5*s)),i=this.stateDerivative(this.addStates(this.state,r,s));this.state.theta1+=s/6*(a.theta1+2*o.theta1+2*r.theta1+i.theta1),this.state.theta2+=s/6*(a.theta2+2*o.theta2+2*r.theta2+i.theta2),this.state.omega1+=s/6*(a.omega1+2*o.omega1+2*r.omega1+i.omega1),this.state.omega2+=s/6*(a.omega2+2*o.omega2+2*r.omega2+i.omega2),(!isFinite(this.state.theta1)||!isFinite(this.state.theta2)||!isFinite(this.state.omega1)||!isFinite(this.state.omega2)||Math.abs(this.state.omega1)>1e6||Math.abs(this.state.omega2)>1e6)&&(this.state={theta1:Math.PI/2,theta2:Math.PI/2,omega1:0,omega2:0});const h=this.calculatePositions();this.positions.push(h),this.points.push(new L(h.p2.x,h.p2.y,0));const u=1e-7,c={theta1:this.state.theta1+this.pertState.theta1*u,theta2:this.state.theta2+this.pertState.theta2*u,omega1:this.state.omega1+this.pertState.omega1*u,omega2:this.state.omega2+this.pertState.omega2*u},p=this.stateDerivative(this.state),m=this.stateDerivative(c);if(this.pertState.theta1+=(m.theta1-p.theta1)/u*s,this.pertState.theta2+=(m.theta2-p.theta2)/u*s,this.pertState.omega1+=(m.omega1-p.omega1)/u*s,this.pertState.omega2+=(m.omega2-p.omega2)/u*s,this.stepsSinceRenorm++,this.stepsSinceRenorm>=this.RENORM_INTERVAL){const g=Math.sqrt(this.pertState.theta1**2+this.pertState.theta2**2+this.pertState.omega1**2+this.pertState.omega2**2);if(g>0&&isFinite(g)){this.lyapunovSum+=Math.log(g),this.lyapunovSteps++,this.pertState.theta1/=g,this.pertState.theta2/=g,this.pertState.omega1/=g,this.pertState.omega2/=g;const R=this.lyapunovSteps*this.RENORM_INTERVAL*this.dt;this.lyapunovExponent=this.lyapunovSum/R}this.stepsSinceRenorm=0}const f=(this.state.theta2%(2*Math.PI)+2*Math.PI)%(2*Math.PI);return(this.prevTheta2%(2*Math.PI)+2*Math.PI)%(2*Math.PI)>Math.PI&&f<=Math.PI&&f<1&&this.points.length>100&&(this.poincarePoints.push([this.state.theta1,this.state.omega1]),this.poincarePoints.length>this.MAX_POINCARE&&this.poincarePoints.splice(0,this.poincarePoints.length-this.MAX_POINCARE)),this.prevTheta2=this.state.theta2,new L(h.p2.x,h.p2.y,0)}reset(t={theta1:Math.PI/2,theta2:Math.PI/2,omega1:0,omega2:0}){this.state={...t};const s=this.calculatePositions();this.positions=[s],this.points=[new L(s.p2.x,s.p2.y,0)],this.pertState={theta1:1e-6,theta2:0,omega1:0,omega2:0},this.lyapunovSum=0,this.lyapunovSteps=0,this.lyapunovExponent=0,this.stepsSinceRenorm=0,this.prevTheta2=t.theta2,this.poincarePoints=[]}updateParams(t){this.params={...this.params,...t}}trimTrail(t){if(this.points.length>t){const s=this.points.length-t;this.points.splice(0,s),this.positions.splice(0,s)}}getSpeed(){if(this.points.length<2)return 0;const t=this.points[this.points.length-1],s=this.points[this.points.length-2];return t.distanceTo(s)}getCurrentPositions(){return this.positions[this.positions.length-1]}getState(){return{...this.state}}}const nt=({position:n=[0,0,0],scale:t=1,initialCondition:s={theta1:Math.PI/2,theta2:Math.PI/2,omega1:0,omega2:0},isSecondary:a=!1,lastPosRef:o})=>{const r=l.useRef(null),{isPlaying:i,speed:h,trailLength:u,doublePendulumParams:c,_resetCounter:p,colorTheme:m,showLyapunov:f,setLyapunovExponent:d,showPoincare:g,currentSystem:R}=z(),x=I[m],y=l.useMemo(()=>new at(s,c),[s.theta1,s.theta2,s.omega1,s.omega2,c.mass1,c.mass2,c.length1,c.length2,c.gravity,c.damping]);l.useEffect(()=>{y.reset(s)},[p]),l.useEffect(()=>{y.updateParams(c)},[c,y]),l.useEffect(()=>(a||ye(y,"doublePendulum"),()=>{a||be(y)}),[y,a]);const P=l.useRef(0);q(()=>{if(!i)return;y.step(h*2),y.trimTrail(u);const A=y.points;if(o&&A.length>0){const N=A[A.length-1];o.current=new L(N.x,N.y,0)}!a&&R==="doublePendulum"&&(f||g)&&(P.current++,P.current%30===0&&d(y.lyapunovExponent))});const E=y.positions.length>0?y.getCurrentPositions():{p1:{x:0,y:0},p2:{x:0,y:0}},T=a?x.trailHue2:x.trailHue1,C=T+.2,j=new W(x.textMuted),k=new W().setHSL(T,.8,.6),v=new W().setHSL(T+.1,.8,.7),S=[E.p1.x*t,E.p1.y*t,0],w=[E.p2.x*t,E.p2.y*t,0];return e.jsxs("group",{ref:r,position:n,children:[e.jsx(xe,{points:y.points,hueStart:T,hueEnd:C,lineWidth:1.8,glowIntensity:.4,scale:t,flatZ:!0}),e.jsxs("line",{children:[e.jsx("bufferGeometry",{children:e.jsx("bufferAttribute",{attach:"attributes-position",args:[new Float32Array([0,0,0,...S]),3]})}),e.jsx("lineBasicMaterial",{color:j,linewidth:2,transparent:!0,opacity:.6})]}),e.jsxs("line",{children:[e.jsx("bufferGeometry",{children:e.jsx("bufferAttribute",{attach:"attributes-position",args:[new Float32Array([...S,...w]),3]})}),e.jsx("lineBasicMaterial",{color:j,linewidth:2,transparent:!0,opacity:.6})]}),e.jsxs("mesh",{position:[0,0,0],children:[e.jsx("sphereGeometry",{args:[.03,12,12]}),e.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:.7})]}),e.jsxs("mesh",{position:[S[0],S[1],S[2]],children:[e.jsx("sphereGeometry",{args:[.06*Math.sqrt(c.mass1),16,16]}),e.jsx("meshBasicMaterial",{color:k})]}),e.jsx(ve,{position:[w[0],w[1],w[2]],color:v,lightIntensity:a?.3:.6,size:.8*Math.sqrt(c.mass2),showPulse:!a})]})},Z=800,ce=80,rt=.02,ot=()=>{const n=l.useRef(null),{colorTheme:t}=z(),s=I[t],{positions:a,baseSizes:o,phases:r,speeds:i}=l.useMemo(()=>{const p=new Float32Array(Z*3),m=new Float32Array(Z),f=new Float32Array(Z),d=new Float32Array(Z);for(let g=0;g<Z;g++)p[g*3]=(Math.random()-.5)*ce,p[g*3+1]=(Math.random()-.5)*ce,p[g*3+2]=(Math.random()-.5)*ce,m[g]=Math.random()*1.5+.3,f[g]=Math.random()*Math.PI*2,d[g]=.5+Math.random()*2.5;return{positions:p,baseSizes:m,phases:f,speeds:d}},[]),h=l.useMemo(()=>new Float32Array(Z),[]),u=l.useRef(null),c=l.useMemo(()=>new W(s.starColor),[s.starColor]);return q(({clock:p})=>{if(!n.current)return;const m=p.getElapsedTime(),f=m*rt;n.current.rotation.y=f,n.current.rotation.x=f*.3;for(let d=0;d<Z;d++){const g=.6+.4*Math.sin(m*i[d]+r[d]);h[d]=o[d]*g}u.current&&(u.current.set(h),u.current.needsUpdate=!0)}),e.jsxs("points",{ref:n,children:[e.jsxs("bufferGeometry",{children:[e.jsx("bufferAttribute",{attach:"attributes-position",args:[a,3]}),e.jsx("bufferAttribute",{ref:u,attach:"attributes-size",args:[new Float32Array(Z),1]})]}),e.jsx("pointsMaterial",{color:c,size:.09,transparent:!0,opacity:.5,sizeAttenuation:!0,depthWrite:!1,blending:ee})]})},it={lorenz:.1,rossler:.5,doublePendulum:1},Ee=20,lt={lorenz:.8,rossler:4,doublePendulum:2},ct={lorenz:.4,rossler:2,doublePendulum:.5},ut=.025,ht=.04,dt=()=>{const{cinematicCamera:n,currentSystem:t,isPlaying:s}=z(),{camera:a}=Ve(),o=l.useRef(new L),r=l.useRef(new L),i=l.useRef(!1),h=l.useRef(!1),u=l.useRef(new L),c=l.useRef(new Ue),p=l.useRef(0);return q(()=>{if(n&&!h.current&&(u.current.copy(a.position),c.current.copy(a.rotation),p.current=0,h.current=!0),!n&&h.current){h.current=!1,i.current=!1;return}if(!n){i.current=!1;return}const m=G.system;if(!m?.points||m.points.length<Ee+5)return;const f=m.points,d=it[t]??.1,g=lt[t]??1,R=ct[t]??.5,x=f.length-1,y=Math.max(0,x-Ee),P=f[x],E=f[y],T=new L().subVectors(P,E).normalize();T.lengthSq()<.001&&T.set(0,0,1);const C=t==="doublePendulum";let j,k;if(C){const A=new L(P.x*d,P.y*d,0);j=new L(A.x*.3,A.y*.3+.5,g),k=A}else{const A=new L(P.x*d,P.y*d,P.z*d),N=new L(0,1,0),M=new L().crossVectors(T,N);M.lengthSq()<.001&&M.set(1,0,0),M.normalize();const B=T.clone().multiplyScalar(-g*d).add(N.clone().multiplyScalar(R*d)).add(M.clone().multiplyScalar(.15*d));j=A.clone().add(B);const D=Math.min(x,f.length-1),F=f[D];k=new L(F.x*d,F.y*d,F.z*d)}i.current||(o.current.copy(a.position),r.current.copy(k),i.current=!0),p.current=Math.min(1,p.current+.008);const v=p.current,S=v*v*(3-2*v),w=s?ut+(1-S)*.1:.005;o.current.lerp(j,w),r.current.lerp(k,ht+(1-S)*.1),a.position.copy(o.current),a.lookAt(r.current)}),null},mt=[{params:{sigma:10,rho:28,beta:2.667},duration:5,transitionTime:4},{params:{sigma:10,rho:15,beta:2.667},duration:3,transitionTime:5},{params:{sigma:10,rho:24.06,beta:2.667},duration:4,transitionTime:4},{params:{sigma:10,rho:28,beta:2.667},duration:3,transitionTime:3},{params:{sigma:14,rho:35,beta:3},duration:4,transitionTime:5},{params:{sigma:10,rho:99.96,beta:2.667},duration:5,transitionTime:6},{params:{sigma:10,rho:45,beta:2.667},duration:3,transitionTime:4},{params:{sigma:10,rho:28,beta:2.667},duration:3,transitionTime:4}],pt=[{params:{a:.2,b:.2,c:3.5},duration:4,transitionTime:5},{params:{a:.2,b:.2,c:4},duration:3,transitionTime:4},{params:{a:.2,b:.2,c:5},duration:3,transitionTime:4},{params:{a:.2,b:.2,c:5.7},duration:4,transitionTime:3},{params:{a:.2,b:.2,c:8.5},duration:4,transitionTime:5},{params:{a:.3,b:.3,c:12},duration:5,transitionTime:5},{params:{a:.2,b:.2,c:5.7},duration:3,transitionTime:6}],ft=[{params:{mass1:1,mass2:1,length1:1,length2:1,gravity:9.81,damping:0},duration:5,transitionTime:4},{params:{mass1:1,mass2:3,length1:1,length2:1,gravity:9.81,damping:0},duration:4,transitionTime:5},{params:{mass1:2,mass2:1,length1:1.5,length2:.5,gravity:9.81,damping:0},duration:4,transitionTime:5},{params:{mass1:1,mass2:1,length1:1,length2:1,gravity:15,damping:0},duration:4,transitionTime:4},{params:{mass1:1,mass2:1,length1:1,length2:1,gravity:5,damping:.02},duration:5,transitionTime:5},{params:{mass1:1,mass2:1,length1:1,length2:1,gravity:9.81,damping:0},duration:3,transitionTime:4}],gt={lorenz:mt,rossler:pt,doublePendulum:ft};function yt(n,t,s){const a={},o=s*s*(3-2*s);for(const r of Object.keys(n)){const i=n[r]??0,h=t[r]??i;a[r]=i+(h-i)*o}return a}const bt=()=>{const{chaosAutopilot:n,currentSystem:t,setLorenzParams:s,setRosslerParams:a,setDoublePendulumParams:o,setCurrentPreset:r}=z(),i=l.useRef(0),h=l.useRef(0),u=l.useRef("dwell"),c=l.useRef(0);return l.useEffect(()=>{i.current=0,h.current=0,u.current="dwell",c.current=0},[n,t]),q((p,m)=>{if(!n)return;const f=gt[t];if(!f||f.length===0)return;const d=h.current%f.length,g=(d+1)%f.length,R=f[d],x=f[g];if(c.current+=m,u.current==="dwell")c.current>=R.duration&&(u.current="transition",c.current=0);else{const y=Math.min(1,c.current/R.transitionTime),P=yt(R.params,x.params,y);switch(t){case"lorenz":s(P);break;case"rossler":a(P);break;case"doublePendulum":o(P);break}r(null),y>=1&&(h.current=g,u.current="dwell",c.current=0)}i.current+=m}),null},U=150,xt=2,Me=50,ue=.96,vt={lorenz:.1,rossler:.5,doublePendulum:1},jt=()=>{const{isPlaying:n,currentSystem:t,colorTheme:s}=z(),a=I[s],o=l.useRef(null),r=l.useRef(0),i=l.useMemo(()=>({positions:new Float32Array(U*3),velocities:new Float32Array(U*3),lifetimes:new Float32Array(U),colors:new Float32Array(U*4),sizes:new Float32Array(U)}),[]),h=l.useMemo(()=>new Q(new Float32Array(U*3),3),[]),u=l.useMemo(()=>new Q(new Float32Array(U*4),4),[]),c=l.useMemo(()=>new Q(new Float32Array(U),1),[]),p=l.useMemo(()=>{const m=new W(a.accent);return{r:m.r,g:m.g,b:m.b}},[a.accent]);return l.useEffect(()=>{i.lifetimes.fill(0),r.current=0},[t,i]),q(()=>{if(!n||!o.current)return;const m=G.system;if(!m?.points||m.points.length<3)return;const f=m.points,d=vt[t]??.1,g=f[f.length-1],R=f[f.length-3],x=(g.x-R.x)*d,y=(g.y-R.y)*d,P=(g.z-R.z)*d,E=Math.sqrt(x*x+y*y+P*P),T=Math.max(.01,E*2);for(let v=0;v<xt;v++){const S=r.current,w=S*3;i.positions[w]=g.x*d,i.positions[w+1]=g.y*d,i.positions[w+2]=t==="doublePendulum"?0:g.z*d,i.velocities[w]=(Math.random()-.5)*T-x*.3,i.velocities[w+1]=(Math.random()-.5)*T-y*.3,i.velocities[w+2]=t==="doublePendulum"?(Math.random()-.5)*.02:(Math.random()-.5)*T-P*.3,i.lifetimes[S]=Me,i.sizes[S]=(.5+Math.random()*1)*d*.5,r.current=(r.current+1)%U}const C=h.array,j=u.array,k=c.array;for(let v=0;v<U;v++){const S=v*3,w=v*4;if(i.lifetimes[v]<=0){C[S]=0,C[S+1]=0,C[S+2]=-1e3,j[w+3]=0,k[v]=0;continue}i.lifetimes[v]--,i.positions[S]+=i.velocities[S]*.016,i.positions[S+1]+=i.velocities[S+1]*.016,i.positions[S+2]+=i.velocities[S+2]*.016,i.velocities[S]*=ue,i.velocities[S+1]*=ue,i.velocities[S+2]*=ue;const A=i.lifetimes[v]/Me,N=A*A,M=.8+Math.sin(i.lifetimes[v]*.5+v*.7)*.2;C[S]=i.positions[S],C[S+1]=i.positions[S+1],C[S+2]=i.positions[S+2],j[w]=p.r*M,j[w+1]=p.g*M,j[w+2]=p.b*M,j[w+3]=N*M,k[v]=i.sizes[v]*(.3+A*.7)}h.needsUpdate=!0,u.needsUpdate=!0,c.needsUpdate=!0}),e.jsxs("points",{ref:o,children:[e.jsxs("bufferGeometry",{children:[e.jsx("primitive",{object:h,attach:"attributes-position"}),e.jsx("primitive",{object:u,attach:"attributes-color"}),e.jsx("primitive",{object:c,attach:"attributes-size"})]}),e.jsx("pointsMaterial",{vertexColors:!0,size:.04,transparent:!0,opacity:.9,depthWrite:!1,blending:ee,sizeAttenuation:!0})]})},St={lorenz:.1,rossler:.5,doublePendulum:1},Pt=()=>{const{isPlaying:n,currentSystem:t,colorTheme:s,bloomEnabled:a}=z(),o=I[s],r=l.useRef(null),i=l.useRef(null),h=l.useRef(new L),u=l.useRef(0),c=l.useRef(0),p=l.useMemo(()=>new W(o.accent),[o.accent]),m=l.useMemo(()=>new W,[]),f=l.useMemo(()=>new W(1,1,1),[]);return q(()=>{if(!n||!r.current||!i.current)return;const d=G.system;if(!d?.points||d.points.length<3)return;const g=d.points,R=St[t]??.1,x=g[g.length-1],y=x.x*R,P=x.y*R,E=t==="doublePendulum"?.1:x.z*R,T=y-h.current.x,C=P-h.current.y,j=E-h.current.z,k=Math.sqrt(T*T+C*C+j*j);h.current.set(y,P,E),u.current+=(k-u.current)*.08;const v=a?.8:.3,S=Math.min(u.current*8,2),w=v+S;c.current+=(w-c.current)*.06,r.current.position.set(y,P,E),r.current.intensity=c.current,r.current.distance=3+u.current*10,i.current.position.set(y,P,E);const A=.03+u.current*.15;i.current.scale.setScalar(A);const N=Math.min(u.current*3,.6);m.copy(p).lerp(f,N),r.current.color.copy(m),i.current.material.color.copy(m)}),e.jsxs(e.Fragment,{children:[e.jsx("pointLight",{ref:r,intensity:.5,distance:5,decay:2,color:o.accent}),e.jsxs("mesh",{ref:i,children:[e.jsx("sphereGeometry",{args:[1,16,16]}),e.jsx("meshBasicMaterial",{color:o.accent,transparent:!0,opacity:.7,depthWrite:!1,blending:ee})]})]})},Ce={lorenz:{position:[10,10,10],fov:60},rossler:{position:[8,8,8],fov:60},doublePendulum:{position:[0,0,5],fov:50}},wt=()=>{const{autoRotate:n,currentSystem:t,cinematicCamera:s}=z();return s?null:e.jsx(Ke,{enablePan:!0,enableZoom:!0,enableRotate:!0,autoRotate:n&&t!=="doublePendulum",autoRotateSpeed:2,maxPolarAngle:Math.PI,minDistance:2,maxDistance:20})},Rt=({posA:n,posB:t})=>{const{setDivergence:s,sideBySideMode:a}=z(),o=l.useRef(0);return q(()=>{if(!a||(o.current++,o.current%6!==0))return;const r=n.current,i=t.current;r&&i&&s(r.distanceTo(i))}),null},he=({position:n=[0,0,0],initialCondition:t,colorHue:s=.6,isSecondary:a=!1,lastPosRef:o})=>{const{currentSystem:r}=z();switch(r){case"lorenz":return e.jsx(et,{position:n,initialCondition:t||[1,1,1],colorHue:s,isSecondary:a,lastPosRef:o});case"rossler":return e.jsx(st,{position:n,initialCondition:t||[1,1,1],colorHue:s,isSecondary:a,lastPosRef:o});case"doublePendulum":return e.jsx(nt,{position:n,initialCondition:t||{theta1:Math.PI/2,theta2:Math.PI/2,omega1:0,omega2:0},colorHue:s,isSecondary:a,lastPosRef:o});default:return null}},Tt=()=>{const{bloomEnabled:n,bloomIntensity:t,isPlaying:s}=z(),a=l.useRef(null),o=l.useRef(t);return q(()=>{if(!n||!a.current)return;if(!s){a.current.intensity=t;return}const r=G.system;if(!r?.points||r.points.length<5){a.current.intensity=t;return}const i=r.points,h=i[i.length-1],u=i[i.length-4],c=h.x-u.x,p=h.y-u.y,m=h.z-u.z,f=Math.sqrt(c*c+p*p+m*m),d=1+Math.min(f*.02,.3),g=t*d;o.current+=(g-o.current)*.05,a.current.intensity=o.current}),n?e.jsx(Xe,{children:e.jsx(Ze,{ref:a,intensity:t,luminanceThreshold:.1,luminanceSmoothing:.9,mipmapBlur:!0})}):null},Et=()=>{const{sideBySideMode:n,currentSystem:t,initialOffset:s,colorTheme:a}=z(),o=I[a],r=l.useRef(null),i=l.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsx("ambientLight",{intensity:.2}),e.jsx("directionalLight",{position:[10,10,5],intensity:.3}),e.jsx(ot,{}),t==="doublePendulum"&&e.jsx(Ye,{args:[10,10],position:[0,-3,0],cellColor:"#222233",sectionColor:"#333355",fadeDistance:25,fadeStrength:1}),n?e.jsxs(e.Fragment,{children:[e.jsx(he,{position:[0,0,0],initialCondition:t==="doublePendulum"?{theta1:Math.PI/2,theta2:Math.PI/2,omega1:0,omega2:0}:[1,1,1],colorHue:o.trailHue1,isSecondary:!1,lastPosRef:r}),e.jsx(he,{position:[0,0,0],initialCondition:t==="doublePendulum"?{theta1:Math.PI/2+s,theta2:Math.PI/2,omega1:0,omega2:0}:[1+s,1,1],colorHue:o.trailHue2,isSecondary:!0,lastPosRef:i}),e.jsx(Rt,{posA:r,posB:i})]}):e.jsx(he,{}),e.jsx(wt,{}),e.jsx(dt,{}),e.jsx(bt,{}),e.jsx(jt,{}),e.jsx(Pt,{}),e.jsx(Tt,{})]})};class Mt extends l.Component{state={hasError:!1,error:null};static getDerivedStateFromError(t){return{hasError:!0,error:t}}handleRetry=()=>{this.setState({hasError:!1,error:null})};render(){return this.state.hasError?e.jsxs("div",{style:{width:"100vw",height:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#000010",color:"#ccc",fontFamily:"system-ui, sans-serif",textAlign:"center",padding:"2rem"},children:[e.jsx("h2",{style:{color:"#ff6666",marginBottom:"1rem"},children:"âš ï¸ Rendering Error"}),e.jsx("p",{style:{maxWidth:"400px",lineHeight:1.6,marginBottom:"1rem"},children:"The 3D visualization encountered an error. This can happen if WebGL is not available or if GPU resources were exhausted."}),e.jsx("code",{style:{background:"rgba(255,255,255,0.05)",padding:"8px 16px",borderRadius:"6px",fontSize:"12px",color:"#ff9999",marginBottom:"1.5rem",maxWidth:"80vw",overflow:"auto"},children:this.state.error?.message||"Unknown error"}),e.jsx("button",{onClick:this.handleRetry,style:{padding:"12px 24px",background:"#88ccff",color:"#000",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:600,cursor:"pointer"},children:"ðŸ”„ Retry"})]}):this.props.children}}const Ct=()=>{const{currentSystem:n,colorTheme:t}=z(),s=I[t],a=Ce[n]??Ce.lorenz;return e.jsx(Mt,{children:e.jsx("div",{style:{width:"100vw",height:"100vh",background:s.bg},role:"img","aria-label":`3D visualization of ${n==="lorenz"?"Lorenz attractor":n==="rossler"?"RÃ¶ssler attractor":"double pendulum"} chaos system`,children:e.jsxs(We,{camera:{position:a.position,fov:a.fov},gl:{antialias:!0,alpha:!0,powerPreference:"high-performance",preserveDrawingBuffer:!0},children:[e.jsx("color",{attach:"background",args:[s.bg]}),e.jsx("fog",{attach:"fog",args:[s.bg,30,60]}),e.jsx(l.Suspense,{fallback:null,children:e.jsx(Et,{})})]})})})},kt={classic:"ðŸŒŒ Classic",neon:"ðŸ’œ Neon",blueprint:"ðŸ“ Blueprint",terminal:"ðŸ’» Terminal"},At={lorenz:"ðŸ¦‹ Lorenz",rossler:"ðŸŒ€ RÃ¶ssler",doublePendulum:"âš¡ Pendulum"},Nt=()=>{const[n,t]=l.useState(!1),[s,a]=l.useState(!1);l.useEffect(()=>{const b=()=>a(window.innerWidth<=768);return b(),window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]);const{currentSystem:o,setCurrentSystem:r,isPlaying:i,setIsPlaying:h,speed:u,setSpeed:c,trailLength:p,setTrailLength:m,sideBySideMode:f,setSideBySideMode:d,initialOffset:g,setInitialOffset:R,autoRotate:x,setAutoRotate:y,currentPreset:P,setCurrentPreset:E,colorTheme:T,setColorTheme:C,lorenzParams:j,setLorenzParams:k,rosslerParams:v,setRosslerParams:S,doublePendulumParams:w,setDoublePendulumParams:A,resetSimulation:N,showLyapunov:M,setShowLyapunov:B,showBifurcation:D,setShowBifurcation:F,showPoincare:_,setShowPoincare:se,showParameterSpace:$,setShowParameterSpace:V,cinematicCamera:O,setCinematicCamera:te,chaosAutopilot:H,setChaosAutopilot:oe,setStoryMode:Le,bloomEnabled:je,setBloomEnabled:Fe,bloomIntensity:ie,setBloomIntensity:Ie,audioEnabled:ae,setAudioEnabled:Be,audioVolume:le,setAudioVolume:De}=z(),K=I[T],Oe=b=>{const ne=Te[o].find(qe=>qe.name===b);if(ne){switch(o){case"lorenz":k(ne.params);break;case"rossler":S(ne.params);break;case"doublePendulum":A(ne.params);break}E(b)}},_e=b=>{r(b),E(null)},Se=b=>b>=.01?b.toFixed(3):b.toExponential(1),$e=()=>{switch(o){case"lorenz":return e.jsxs("div",{className:"parameter-group",role:"group","aria-label":"Lorenz system parameters",children:[e.jsx("h4",{children:"Lorenz Parameters"}),e.jsxs("div",{className:"slider-group",children:[e.jsxs("label",{htmlFor:"sigma-slider",children:["Ïƒ (sigma): ",j.sigma.toFixed(2)]}),e.jsx("input",{id:"sigma-slider",type:"range",min:"0.1",max:"30",step:"0.1",value:j.sigma,"aria-valuemin":.1,"aria-valuemax":30,"aria-valuenow":j.sigma,"aria-label":`Sigma: ${j.sigma.toFixed(2)}`,onChange:b=>k({sigma:parseFloat(b.target.value)})})]}),e.jsxs("div",{className:"slider-group",children:[e.jsxs("label",{htmlFor:"rho-slider",children:["Ï (rho): ",j.rho.toFixed(2)]}),e.jsx("input",{id:"rho-slider",type:"range",min:"0.1",max:"50",step:"0.1",value:j.rho,"aria-valuemin":.1,"aria-valuemax":50,"aria-valuenow":j.rho,"aria-label":`Rho: ${j.rho.toFixed(2)}`,onChange:b=>k({rho:parseFloat(b.target.value)})})]}),e.jsxs("div",{className:"slider-group",children:[e.jsxs("label",{htmlFor:"beta-slider",children:["Î² (beta): ",j.beta.toFixed(3)]}),e.jsx("input",{id:"beta-slider",type:"range",min:"0.1",max:"10",step:"0.01",value:j.beta,"aria-valuemin":.1,"aria-valuemax":10,"aria-valuenow":j.beta,"aria-label":`Beta: ${j.beta.toFixed(3)}`,onChange:b=>k({beta:parseFloat(b.target.value)})})]})]});case"rossler":return e.jsxs("div",{className:"parameter-group",role:"group","aria-label":"RÃ¶ssler system parameters",children:[e.jsx("h4",{children:"RÃ¶ssler Parameters"}),e.jsxs("div",{className:"slider-group",children:[e.jsxs("label",{htmlFor:"a-slider",children:["a: ",v.a.toFixed(3)]}),e.jsx("input",{id:"a-slider",type:"range",min:"0.01",max:"1.0",step:"0.01",value:v.a,"aria-label":`Parameter a: ${v.a.toFixed(3)}`,onChange:b=>S({a:parseFloat(b.target.value)})})]}),e.jsxs("div",{className:"slider-group",children:[e.jsxs("label",{htmlFor:"b-slider",children:["b: ",v.b.toFixed(3)]}),e.jsx("input",{id:"b-slider",type:"range",min:"0.01",max:"1.0",step:"0.01",value:v.b,"aria-label":`Parameter b: ${v.b.toFixed(3)}`,onChange:b=>S({b:parseFloat(b.target.value)})})]}),e.jsxs("div",{className:"slider-group",children:[e.jsxs("label",{htmlFor:"c-slider",children:["c: ",v.c.toFixed(2)]}),e.jsx("input",{id:"c-slider",type:"range",min:"1.0",max:"20.0",step:"0.1",value:v.c,"aria-label":`Parameter c: ${v.c.toFixed(2)}`,onChange:b=>S({c:parseFloat(b.target.value)})})]})]});case"doublePendulum":return e.jsxs("div",{className:"parameter-group",role:"group","aria-label":"Double pendulum parameters",children:[e.jsx("h4",{children:"Pendulum Parameters"}),e.jsxs("div",{className:"slider-group",children:[e.jsxs("label",{htmlFor:"mass1-slider",children:["Mass 1: ",w.mass1.toFixed(2)]}),e.jsx("input",{id:"mass1-slider",type:"range",min:"0.1",max:"5.0",step:"0.1",value:w.mass1,"aria-label":`Mass 1: ${w.mass1.toFixed(2)}`,onChange:b=>A({mass1:parseFloat(b.target.value)})})]}),e.jsxs("div",{className:"slider-group",children:[e.jsxs("label",{htmlFor:"mass2-slider",children:["Mass 2: ",w.mass2.toFixed(2)]}),e.jsx("input",{id:"mass2-slider",type:"range",min:"0.1",max:"5.0",step:"0.1",value:w.mass2,"aria-label":`Mass 2: ${w.mass2.toFixed(2)}`,onChange:b=>A({mass2:parseFloat(b.target.value)})})]}),e.jsxs("div",{className:"slider-group",children:[e.jsxs("label",{htmlFor:"len1-slider",children:["Length 1: ",w.length1.toFixed(2)]}),e.jsx("input",{id:"len1-slider",type:"range",min:"0.2",max:"2.0",step:"0.1",value:w.length1,"aria-label":`Length 1: ${w.length1.toFixed(2)}`,onChange:b=>A({length1:parseFloat(b.target.value)})})]}),e.jsxs("div",{className:"slider-group",children:[e.jsxs("label",{htmlFor:"len2-slider",children:["Length 2: ",w.length2.toFixed(2)]}),e.jsx("input",{id:"len2-slider",type:"range",min:"0.2",max:"2.0",step:"0.1",value:w.length2,"aria-label":`Length 2: ${w.length2.toFixed(2)}`,onChange:b=>A({length2:parseFloat(b.target.value)})})]}),e.jsxs("div",{className:"slider-group",children:[e.jsxs("label",{htmlFor:"gravity-slider",children:["Gravity: ",w.gravity.toFixed(2)]}),e.jsx("input",{id:"gravity-slider",type:"range",min:"1.0",max:"20.0",step:"0.1",value:w.gravity,"aria-label":`Gravity: ${w.gravity.toFixed(2)}`,onChange:b=>A({gravity:parseFloat(b.target.value)})})]}),e.jsxs("div",{className:"slider-group",children:[e.jsxs("label",{htmlFor:"damping-slider",children:["Damping: ",w.damping.toFixed(3)]}),e.jsx("input",{id:"damping-slider",type:"range",min:"0.0",max:"0.2",step:"0.005",value:w.damping,"aria-label":`Damping: ${w.damping.toFixed(3)}`,onChange:b=>A({damping:parseFloat(b.target.value)})})]})]});default:return null}};return e.jsxs("aside",{className:`controls ${n?"collapsed":""} ${s?"mobile":""}`,role:"region","aria-label":"Simulation controls",style:{"--panel-bg":K.panelBg,"--panel-border":K.panelBorder,"--text-color":K.text,"--text-muted":K.textMuted,"--accent":K.accent,"--accent2":K.accent2,"--heading":K.heading,"--param-color":K.paramColor},children:[e.jsx("button",{className:"controls-toggle",onClick:()=>t(!n),"aria-label":n?"Show controls":"Hide controls","aria-expanded":!n,children:n?"âš™ï¸":"âœ•"}),!n&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"control-section",children:[e.jsx("h3",{id:"system-heading",children:"Chaos System"}),e.jsx("div",{className:"system-tabs",role:"tablist","aria-labelledby":"system-heading",children:["lorenz","rossler","doublePendulum"].map(b=>e.jsx("button",{role:"tab","aria-selected":o===b,"aria-label":`Select ${b==="doublePendulum"?"Double Pendulum":b} system`,className:`system-tab ${o===b?"active":""}`,onClick:()=>_e(b),children:At[b]},b))})]}),e.jsxs("div",{className:"control-section",children:[e.jsx("h3",{children:"Simulation"}),e.jsxs("div",{className:"button-group",children:[e.jsx("button",{onClick:()=>h(!i),className:`play-button ${i?"playing":"paused"}`,"aria-label":i?"Pause simulation":"Play simulation",children:i?"â¸ Pause":"â–¶ Play"}),e.jsx("button",{onClick:N,className:"reset-button","aria-label":"Reset simulation",children:"ðŸ”„ Reset"})]}),e.jsxs("div",{className:"slider-group",children:[e.jsxs("label",{htmlFor:"speed-slider",children:["Speed: ",u.toFixed(1),"x"]}),e.jsx("input",{id:"speed-slider",type:"range",min:"0.1",max:"5.0",step:"0.1",value:u,"aria-label":`Simulation speed: ${u.toFixed(1)}x`,onChange:b=>c(parseFloat(b.target.value))})]}),e.jsxs("div",{className:"slider-group",children:[e.jsxs("label",{htmlFor:"trail-slider",children:["Trail: ",p,p>3e3&&e.jsx("span",{className:"warn",children:" âš ï¸ High"})]}),e.jsx("input",{id:"trail-slider",type:"range",min:"100",max:"5000",step:"100",value:p,"aria-label":`Trail length: ${p} points`,onChange:b=>m(parseInt(b.target.value))})]})]}),e.jsxs("div",{className:"control-section butterfly-section",children:[e.jsx("h3",{children:"ðŸ¦‹ Butterfly Effect"}),e.jsx("div",{className:"checkbox-group",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:f,"aria-label":"Enable butterfly mode: show two systems with tiny initial difference",onChange:b=>{d(b.target.checked),b.target.checked&&N()}}),"Enable Butterfly Mode"]})}),f&&e.jsxs("div",{className:"slider-group offset-slider",children:[e.jsxs("label",{htmlFor:"offset-slider",children:["Initial Offset: ",e.jsx("span",{className:"offset-value",children:Se(g)})]}),e.jsx("input",{id:"offset-slider",type:"range",min:"-6",max:"-0.5",step:"0.1",value:Math.log10(g),"aria-label":`Initial offset between systems: ${Se(g)}`,onChange:b=>{R(Math.pow(10,parseFloat(b.target.value))),N()}}),e.jsxs("div",{className:"offset-labels","aria-hidden":"true",children:[e.jsx("span",{children:"Tiny"}),e.jsx("span",{children:"Large"})]})]})]}),e.jsxs("div",{className:"control-section",children:[e.jsx("h3",{children:"View"}),o!=="doublePendulum"&&e.jsx("div",{className:"checkbox-group",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:x,"aria-label":"Auto-rotate camera around the attractor",onChange:b=>y(b.target.checked)}),"Auto Rotate"]})}),e.jsx("div",{className:"checkbox-group",children:e.jsxs("label",{children:[e.jsx("input",{type:"checkbox",checked:je,"aria-label":"Toggle bloom glow post-processing effect",onChange:b=>Fe(b.target.checked)}),"âœ¨ Bloom Glow"]})}),je&&e.jsxs("div",{className:"slider-group",children:[e.jsxs("label",{htmlFor:"bloom-intensity",children:["Bloom: ",ie.toFixed(1)]}),e.jsx("input",{id:"bloom-intensity",type:"range",min:"0.2",max:"4.0",step:"0.1",value:ie,"aria-label":`Bloom intensity: ${ie.toFixed(1)}`,onChange:b=>Ie(parseFloat(b.target.value))})]})]}),e.jsxs("div",{className:"control-section",children:[e.jsx("h3",{children:"âœ¨ Experience"}),e.jsxs("div",{className:"experience-buttons",children:[e.jsx("button",{className:`experience-btn cinematic ${O?"active":""}`,onClick:()=>te(!O),"aria-pressed":O,"aria-label":"Toggle cinematic chase camera that follows the trail",children:"ðŸŽ¬ Chase Cam"}),e.jsx("button",{className:`experience-btn autopilot ${H?"active":""}`,onClick:()=>oe(!H),"aria-pressed":H,"aria-label":"Toggle chaos autopilot that morphs parameters automatically",children:"ðŸ¤– Autopilot"}),e.jsx("button",{className:`experience-btn audio ${ae?"active":""}`,onClick:()=>Be(!ae),"aria-pressed":ae,"aria-label":"Toggle chaos sonification â€” hear the attractor as sound",children:"ðŸ”Š Sonify"}),e.jsx("button",{className:"experience-btn story",onClick:()=>{Le(!0),y(!0)},"aria-label":"Launch guided story mode tour",children:"ðŸ“– Story Mode"})]}),ae&&e.jsxs("div",{className:"audio-controls",children:[e.jsxs("div",{className:"slider-group",children:[e.jsxs("label",{htmlFor:"audio-volume",children:["Volume: ",Math.round(le*100),"%"]}),e.jsx("input",{id:"audio-volume",type:"range",min:"0",max:"1",step:"0.05",value:le,"aria-label":`Audio volume: ${Math.round(le*100)}%`,onChange:b=>De(parseFloat(b.target.value))})]}),e.jsx("div",{className:"autopilot-hint",children:"ðŸŽµ Listening to chaos â€” pitch follows position, volume follows velocity"})]}),H&&e.jsx("div",{className:"autopilot-hint",children:"Parameters are morphing through interesting regions..."}),O&&e.jsx("div",{className:"autopilot-hint",children:"Camera is following the trail head. Orbit controls disabled."})]}),e.jsxs("div",{className:"control-section",children:[e.jsx("h3",{id:"theme-heading",children:"Theme"}),e.jsx("div",{className:"theme-grid",role:"radiogroup","aria-labelledby":"theme-heading",children:Object.keys(I).map(b=>e.jsx("button",{role:"radio","aria-checked":T===b,"aria-label":`${b} theme`,className:`theme-btn ${T===b?"active":""}`,onClick:()=>C(b),style:{"--tbg":I[b].bg,"--taccent":I[b].accent},children:kt[b]},b))})]}),e.jsxs("div",{className:"control-section",children:[e.jsx("h3",{children:"Presets"}),e.jsx("div",{className:"preset-chips",role:"group","aria-label":"Parameter presets",children:Te[o].map(b=>e.jsx("button",{className:`preset-chip ${P===b.name?"active":""}`,onClick:()=>Oe(b.name),"aria-label":`${b.name}: ${b.description}`,"aria-pressed":P===b.name,children:b.name},b.name))})]}),$e(),o!=="doublePendulum"&&e.jsxs("div",{className:"control-section",children:[e.jsx("h3",{children:"ðŸ”¬ Analysis"}),e.jsxs("div",{className:"analysis-buttons",children:[e.jsx("button",{className:`analysis-btn ${M?"active":""}`,onClick:()=>B(!M),"aria-pressed":M,"aria-label":"Toggle Lyapunov exponent indicator",children:"Î» Lyapunov"}),e.jsx("button",{className:`analysis-btn ${D?"active":""}`,onClick:()=>F(!D),"aria-pressed":D,"aria-label":"Toggle bifurcation diagram",children:"ðŸ“ˆ Bifurcation"}),e.jsx("button",{className:`analysis-btn ${_?"active":""}`,onClick:()=>se(!_),"aria-pressed":_,"aria-label":"Toggle PoincarÃ© section",children:"â—Ž PoincarÃ©"}),e.jsx("button",{className:`analysis-btn ${$?"active":""}`,onClick:()=>V(!$),"aria-pressed":$,"aria-label":"Toggle parameter space explorer",children:"ðŸ—ºï¸ Param Space"})]})]})]})]})},zt={lorenz:{title:"Lorenz Attractor",description:"The Lorenz attractor is a set of chaotic solutions of the Lorenz system, discovered by Edward Lorenz in 1963. It arises from a simplified model of atmospheric convection.",equations:["dx/dt = Ïƒ(y - x)","dy/dt = x(Ï - z) - y","dz/dt = xy - Î²z"],whatMakesChaotic:'The system is chaotic because small changes in initial conditions lead to drastically different outcomes over time. This is the famous "butterfly effect" â€” a butterfly flapping its wings in Brazil could theoretically cause a tornado in Texas.',parameters:{"Ïƒ (sigma)":"Prandtl number â€” relates viscosity to thermal conductivity","Ï (rho)":"Rayleigh number â€” measures temperature difference","Î² (beta)":"Geometric factor related to the size of convection cells"}},rossler:{title:"RÃ¶ssler Attractor",description:"The RÃ¶ssler attractor is another chaotic system, developed by Otto RÃ¶ssler in 1976. It was designed to be simpler than the Lorenz system while still exhibiting chaotic behavior.",equations:["dx/dt = -y - z","dy/dt = x + ay","dz/dt = b + z(x - c)"],whatMakesChaotic:"The RÃ¶ssler system shows how even simple nonlinear equations can produce chaos. The attractor has a characteristic spiral structure that folds back on itself, creating sensitive dependence on initial conditions.",parameters:{a:"Controls the rate of expansion in the y direction",b:"Constant term that affects the z component",c:"Controls the folding and stretching of the attractor"}},doublePendulum:{title:"Double Pendulum",description:"A double pendulum consists of two pendulums attached end to end. Despite being a deterministic system governed by well-known physical laws, it exhibits chaotic motion.",equations:["Complex coupled differential equations","involving angles Î¸â‚, Î¸â‚‚ and their","angular velocities Ï‰â‚, Ï‰â‚‚"],whatMakesChaotic:"The chaos arises from the nonlinear coupling between the two pendulums. Small changes in the initial angles or velocities can lead to completely different trajectories. This demonstrates that chaos can emerge from simple, everyday systems.",parameters:{"Mass 1, Mass 2":"Masses of the first and second pendulum bobs","Length 1, Length 2":"Lengths of the first and second pendulum arms",Gravity:"Gravitational acceleration",Damping:"Energy loss due to friction (0 = no damping)"}}},Lt=()=>{const{currentSystem:n,showInfoPanel:t,setShowInfoPanel:s}=z();if(!t)return e.jsx("button",{className:"info-toggle collapsed",onClick:()=>s(!0),"aria-label":"Show system information panel",children:"â„¹ï¸"});const a=zt[n];return e.jsxs("aside",{className:"info-panel",role:"complementary","aria-label":"System information",children:[e.jsxs("div",{className:"info-header",children:[e.jsx("h2",{children:a.title}),e.jsx("button",{className:"info-close",onClick:()=>s(!1),"aria-label":"Close information panel",children:"âœ•"})]}),e.jsxs("div",{className:"info-content",children:[e.jsxs("section",{"aria-labelledby":"info-overview",children:[e.jsx("h3",{id:"info-overview",children:"Overview"}),e.jsx("p",{children:a.description})]}),e.jsxs("section",{"aria-labelledby":"info-equations",children:[e.jsx("h3",{id:"info-equations",children:"Equations"}),e.jsx("div",{className:"equations",role:"math","aria-label":"System equations",children:a.equations.map((o,r)=>e.jsx("div",{className:"equation",children:o},r))})]}),e.jsxs("section",{"aria-labelledby":"info-chaos",children:[e.jsx("h3",{id:"info-chaos",children:"What Makes It Chaotic?"}),e.jsx("p",{children:a.whatMakesChaotic})]}),e.jsxs("section",{"aria-labelledby":"info-params",children:[e.jsx("h3",{id:"info-params",children:"Parameters"}),e.jsx("dl",{className:"parameters",children:Object.entries(a.parameters).map(([o,r])=>e.jsxs("div",{className:"parameter",children:[e.jsx("dt",{children:e.jsx("strong",{children:o})}),e.jsx("dd",{children:r})]},o))})]}),e.jsxs("section",{"aria-labelledby":"info-tips",children:[e.jsx("h3",{id:"info-tips",children:"Tips"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Try the side-by-side mode to see how small changes create big differences"}),e.jsx("li",{children:"Experiment with different presets to explore various behaviors"}),e.jsx("li",{children:"Adjust the trail length to see more or less of the trajectory"}),e.jsx("li",{children:"Use the speed control to slow down and observe the motion closely"})]})]})]})]})},J=[{title:"Welcome to Chaos Lab! ðŸ¦‹",description:"Explore the beautiful world of chaos theory through interactive visualizations. Watch as simple equations create complex, unpredictable patterns."},{title:"Try Side-by-Side Mode",description:"Enable 'Butterfly Mode' to see the butterfly effect in action. Two systems with tiny differences will evolve completely differently!",highlight:"side-by-side"},{title:"Experiment with Parameters",description:"Adjust the sliders to see how small changes in parameters can dramatically alter the behavior. Try the preset configurations for interesting starting points.",highlight:"parameters"},{title:"Explore Different Systems",description:"Switch between Lorenz Attractor, RÃ¶ssler Attractor, and Double Pendulum to see different types of chaotic behavior.",highlight:"systems"},{title:"Hear the Chaos ðŸ”Š",description:"Press M or click 'Sonify' to hear the chaos as sound! The pitch follows the attractor's position and the volume pulses with its velocity. Best with headphones.",highlight:"audio"},{title:"Learn More",description:"Click the info button (â„¹ï¸) to learn about the mathematics and physics behind each system. Ready to explore chaos?",highlight:"info"}],Ft=()=>{const[n,t]=l.useState(!1),[s,a]=l.useState(0),{setSideBySideMode:o,setShowInfoPanel:r}=z(),i=l.useRef(null);l.useEffect(()=>{localStorage.getItem("chaosLabTutorial")||t(!0)},[]),l.useEffect(()=>{n&&i.current&&i.current.focus()},[n,s]);const h=l.useCallback(()=>{localStorage.setItem("chaosLabTutorial","completed"),t(!1)},[]),u=l.useCallback(()=>{s<J.length-1?a(s+1):h()},[s,h]),c=l.useCallback(()=>{switch(J[s].highlight){case"side-by-side":o(!0);break;case"info":r(!0);break}u()},[s,u,o,r]),p=l.useCallback(d=>{d.key==="Escape"?h():(d.key==="Enter"||d.key===" ")&&(d.preventDefault(),u())},[h,u]);if(!n)return null;const m=J[s],f=s===J.length-1;return e.jsx("div",{className:"quick-start-overlay",role:"dialog","aria-modal":"true","aria-label":"Quick start tutorial",onKeyDown:p,children:e.jsxs("div",{className:"quick-start-modal",ref:i,tabIndex:-1,children:[e.jsxs("div",{className:"quick-start-header",children:[e.jsx("h2",{id:"qs-title",children:m.title}),e.jsx("button",{className:"quick-start-close",onClick:h,"aria-label":"Close tutorial",children:"âœ•"})]}),e.jsxs("div",{className:"quick-start-content",children:[e.jsx("p",{id:"qs-desc",children:m.description}),e.jsx("div",{className:"quick-start-progress",role:"progressbar","aria-valuenow":s+1,"aria-valuemin":1,"aria-valuemax":J.length,"aria-label":`Step ${s+1} of ${J.length}`,children:J.map((d,g)=>e.jsx("div",{className:`progress-dot ${g<=s?"active":""}`,"aria-hidden":"true"},g))})]}),e.jsxs("div",{className:"quick-start-actions",children:[e.jsx("button",{className:"quick-start-skip",onClick:h,children:"Skip Tutorial"}),e.jsx("button",{className:"quick-start-next",onClick:m.highlight?c:u,"aria-describedby":"qs-desc",children:f?"Let's Explore!":"Next"})]})]})})},It=()=>{const{sideBySideMode:n,divergence:t,colorTheme:s}=z(),a=I[s];if(!n)return null;const o=Math.log10(Math.max(t,1e-4)),r=Math.min(1,Math.max(0,(o+4)/6)),i=Math.round(r*100),h=(1-r)*120,u=t<.001?t.toExponential(2):t.toFixed(3);return e.jsxs("div",{className:"divergence-meter",role:"meter","aria-label":"Divergence between the two systems","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":1,"aria-valuetext":`Divergence: ${u}`,children:[e.jsx("div",{className:"divergence-label",style:{color:a.textMuted},children:"Divergence"}),e.jsx("div",{className:"divergence-bar-track",children:e.jsx("div",{className:"divergence-bar-fill",style:{width:`${i}%`,background:`hsl(${h}, 90%, 55%)`,boxShadow:`0 0 10px hsla(${h}, 90%, 55%, 0.5), 0 0 20px hsla(${h}, 90%, 55%, 0.2)`}})}),e.jsx("div",{className:"divergence-value",style:{color:`hsl(${h}, 80%, 65%)`,textShadow:`0 0 12px hsla(${h}, 90%, 55%, 0.4)`},children:u})]})},Bt=()=>{const{showLyapunov:n,lyapunovExponent:t,colorTheme:s}=z(),a=I[s],o=l.useRef("");if(!n)return null;const i=(Math.max(-2,Math.min(3,t))+2)/5,h=(1-i)*120,u=Math.min(100,Math.max(5,i*100)),c=t>.1?"Chaotic":t>-.05?"Edge of Chaos":"Stable",p=t>.1?"ðŸ”´":t>-.05?"ðŸŸ¡":"ðŸŸ¢",m=o.current!==c;return m&&(o.current=c),e.jsxs("div",{className:"lyapunov-indicator",role:"region","aria-label":`Lyapunov exponent indicator: system is ${c}`,style:{"--panel-bg":a.panelBg,"--panel-border":a.panelBorder,"--text":a.text,"--text-muted":a.textMuted,"--bar-hue":h},children:[e.jsxs("div",{className:"lyapunov-header",children:[e.jsx("span",{className:"lyapunov-label",children:"Î» (Lyapunov)"}),e.jsxs("span",{className:"lyapunov-status","aria-hidden":"true",children:[p," ",c]})]}),e.jsxs("div",{className:"lyapunov-value",style:{color:`hsl(${h}, 90%, 60%)`},children:["Î» = ",t.toFixed(3)]}),e.jsxs("div",{className:"lyapunov-bar-track",role:"meter","aria-valuenow":t,"aria-valuemin":-2,"aria-valuemax":3,"aria-label":"Lyapunov exponent",children:[e.jsx("div",{className:"lyapunov-bar-fill",style:{width:`${u}%`,background:`hsl(${h}, 85%, 50%)`,boxShadow:`0 0 10px hsla(${h}, 85%, 50%, 0.6)`}}),e.jsx("div",{className:"lyapunov-bar-zero","aria-hidden":"true"})]}),e.jsx("div",{className:"lyapunov-hint",children:"Measures how fast nearby paths diverge. Positive = chaos."}),m&&e.jsxs("div",{className:"sr-only",role:"status","aria-live":"polite","aria-atomic":"true",children:["System is now ",c,", Lyapunov exponent: ",t.toFixed(2)]})]})},Dt=[{key:"Space",action:"Play / Pause simulation"},{key:"R",action:"Reset simulation"},{key:"1",action:"Switch to Lorenz attractor"},{key:"2",action:"Switch to RÃ¶ssler attractor"},{key:"3",action:"Switch to Double Pendulum"},{key:"S",action:"Toggle side-by-side (Butterfly) mode"},{key:"C",action:"Toggle cinematic chase camera"},{key:"A",action:"Toggle chaos autopilot"},{key:"M",action:"Toggle audio sonification"},{key:"B",action:"Toggle bloom glow effect"},{key:"T",action:"Cycle through color themes"},{key:"P",action:"Screenshot current view"},{key:"L",action:"Copy share link to clipboard"},{key:"H / ?",action:"Toggle this help overlay"},{key:"Esc",action:"Close open dialogs"}],Ot=({isVisible:n,onClose:t})=>{const s=l.useRef(null);return l.useEffect(()=>{n&&s.current?.focus()},[n]),l.useEffect(()=>{if(!n)return;const a=o=>{(o.key==="Escape"||o.key==="h"||o.key==="H"||o.key==="?")&&(o.preventDefault(),t())};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[n,t]),n?e.jsx("div",{className:"help-overlay",role:"dialog","aria-modal":"true","aria-label":"Keyboard shortcuts",onClick:t,children:e.jsxs("div",{className:"help-modal",ref:s,tabIndex:-1,onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"help-header",children:[e.jsx("h2",{children:"âŒ¨ï¸ Keyboard Shortcuts"}),e.jsx("button",{className:"help-close",onClick:t,"aria-label":"Close help",children:"âœ•"})]}),e.jsx("div",{className:"help-grid",children:Dt.map(({key:a,action:o})=>e.jsxs("div",{className:"help-row",children:[e.jsx("kbd",{className:"help-key",children:a}),e.jsx("span",{className:"help-action",children:o})]},a))}),e.jsxs("div",{className:"help-footer",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Mouse:"})," Drag to rotate Â· Scroll to zoom Â· Right-drag to pan"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Touch:"})," Drag to rotate Â· Pinch to zoom"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Right-click"})," canvas for quick actions"]})]})]})}):null},_t=12e3,de=2e3,$t=()=>{const{storyMode:n,setStoryMode:t,currentStoryIndex:s,setCurrentStoryIndex:a,setCurrentSystem:o,setLorenzParams:r,setRosslerParams:i,setDoublePendulumParams:h,setTrailLength:u,setSpeed:c,setSideBySideMode:p,setInitialOffset:m,setCurrentPreset:f,setAutoRotate:d,resetSimulation:g,colorTheme:R,setCinematicCamera:x}=z(),y=I[R],P=l.useRef(null),[E,T]=l.useState(!1),[C,j]=l.useState(0),k=l.useCallback(N=>{const M=X[N];if(M){switch(o(M.system),u(M.trailLength),c(M.speed),p(M.sideBySide),m(M.offset),f(null),d(!0),x(!M.sideBySide),M.system){case"lorenz":r(M.params);break;case"rossler":i(M.params);break;case"doublePendulum":h(M.params);break}g()}},[o,r,i,h,u,c,p,m,f,d,x,g]),v=l.useCallback(()=>{T(!0),setTimeout(()=>{const N=(s+1)%X.length;a(N),k(N),j(N),setTimeout(()=>T(!1),100)},de/2)},[s,a,k]),S=l.useCallback(()=>{T(!0),setTimeout(()=>{const N=(s-1+X.length)%X.length;a(N),k(N),j(N),setTimeout(()=>T(!1),100)},de/2)},[s,a,k]);l.useEffect(()=>{n&&(k(s),j(s))},[n]),l.useEffect(()=>{if(n)return P.current=setTimeout(v,_t),()=>{P.current&&clearTimeout(P.current)}},[n,s,v]);const w=l.useCallback(()=>{t(!1),x(!1),d(!1),P.current&&clearTimeout(P.current)},[t,x,d]);if(l.useEffect(()=>{if(!n)return;const N=M=>{M.key==="Escape"?w():M.key==="ArrowRight"||M.key===" "?(M.preventDefault(),v()):M.key==="ArrowLeft"&&(M.preventDefault(),S())};return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[n,v,S,w]),!n)return null;const A=X[C];return A?e.jsxs("div",{className:`story-mode-overlay ${E?"transitioning":""}`,style:{"--story-accent":y.accent,"--story-bg":y.panelBg,"--story-text":y.text,"--story-border":y.panelBorder},children:[e.jsx("div",{className:"story-progress",children:X.map((N,M)=>e.jsx("button",{className:`story-dot ${M===C?"active":""} ${M<C?"visited":""}`,onClick:()=>{T(!0),setTimeout(()=>{a(M),k(M),j(M),setTimeout(()=>T(!1),100)},de/2)},"aria-label":`Go to story ${M+1}: ${X[M].name}`},M))}),e.jsxs("div",{className:"story-card",children:[e.jsx("div",{className:"story-emoji",children:A.emoji}),e.jsxs("div",{className:"story-text",children:[e.jsx("h2",{className:"story-title",children:A.name}),e.jsx("p",{className:"story-description",children:A.description})]}),e.jsxs("div",{className:"story-counter",children:[C+1," / ",X.length]})]}),e.jsxs("div",{className:"story-nav",children:[e.jsx("button",{className:"story-nav-btn",onClick:S,"aria-label":"Previous story",children:"â†"}),e.jsx("button",{className:"story-nav-btn story-exit",onClick:w,"aria-label":"Exit story mode",children:"âœ• Exit"}),e.jsx("button",{className:"story-nav-btn",onClick:v,"aria-label":"Next story",children:"â†’"})]})]}):null},ke={lorenz:{xRange:[-25,25],yRange:[-30,30],zRange:[0,55]},rossler:{xRange:[-15,15],yRange:[-15,15],zRange:[0,30]},doublePendulum:{xRange:[-3,3],yRange:[-3,3],zRange:[-1,1]}};function me(n,t,s,a,o){const r=Math.max(t,Math.min(s,n));return a+(r-t)/(s-t)*(o-a)}const re=[130.81,146.83,164.81,196,220,261.63,293.66,329.63,392,440,523.25,587.33,659.26];function Ae(n){let t=re[0],s=Math.abs(n-t);for(let a=1;a<re.length;a++){const o=Math.abs(n-re[a]);o<s&&(s=o,t=re[a])}return t}const qt=()=>{const{audioEnabled:n,audioVolume:t,currentSystem:s,isPlaying:a}=z(),o=l.useRef(null),r=l.useRef(null),i=l.useRef(null),h=l.useRef(null),u=l.useRef(null),c=l.useRef(null),p=l.useRef(null),m=l.useRef(null),f=l.useRef(0),d=l.useCallback(()=>{if(o.current)return;const x=new AudioContext;o.current=x;const y=x.createOscillator();y.type="sine",y.frequency.value=220,r.current=y;const P=x.createOscillator();P.type="triangle",P.frequency.value=220,P.detune.value=7,i.current=P;const E=x.createBiquadFilter();E.type="lowpass",E.frequency.value=800,E.Q.value=2,u.current=E;const T=x.createGain();T.gain.value=0,h.current=T;const C=x.createGain();C.gain.value=t,c.current=C;const j=x.createDelay(1);j.delayTime.value=.3;const k=x.createGain();k.gain.value=.25;const v=x.createGain();v.gain.value=.3,p.current=v,y.connect(E),P.connect(E),E.connect(T),T.connect(C),T.connect(j),j.connect(k),k.connect(j),j.connect(v),v.connect(C),C.connect(x.destination),y.start(),P.start()},[t]),g=l.useCallback(()=>{if(f.current&&(cancelAnimationFrame(f.current),f.current=0),r.current){try{r.current.stop()}catch{}r.current=null}if(i.current){try{i.current.stop()}catch{}i.current=null}o.current&&(o.current.close(),o.current=null),h.current=null,u.current=null,c.current=null,p.current=null,m.current=null},[]),R=l.useCallback(()=>{const x=o.current,y=r.current,P=i.current,E=h.current,T=u.current;if(!x||!y||!P||!E||!T)return;const C=G.system;if(!C?.points||C.points.length<5){E.gain.setTargetAtTime(0,x.currentTime,.1),f.current=requestAnimationFrame(R);return}const j=G.type||"lorenz",k=C.points,v=k[k.length-1],S=ke[j]||ke.lorenz,w=m.current||v,A=v.x-w.x,N=v.y-w.y,M=v.z-w.z,B=Math.sqrt(A*A+N*N+M*M);m.current={x:v.x,y:v.y,z:v.z};const D=x.currentTime,F=.08,_=me(v.x,S.xRange[0],S.xRange[1],100,600),se=Ae(_);y.frequency.setTargetAtTime(se,D,F);const $=me(v.y,S.yRange[0],S.yRange[1],80,500),V=Ae($)*1.5;P.frequency.setTargetAtTime(V,D,F*1.5);const O=me(v.z,S.zRange[0],S.zRange[1],200,2500);T.frequency.setTargetAtTime(O,D,F);const H=Math.min(1,B/(j==="doublePendulum"?2:15)),oe=H*H*.4;E.gain.setTargetAtTime(oe,D,F),f.current=requestAnimationFrame(R)},[]);return l.useEffect(()=>(n&&a?(d(),setTimeout(()=>{f.current=requestAnimationFrame(R)},100)):g(),()=>{g()}),[n,a,d,g,R]),l.useEffect(()=>{c.current&&o.current&&c.current.gain.setTargetAtTime(t,o.current.currentTime,.05)},[t]),l.useEffect(()=>{n&&h.current&&o.current&&(a||h.current.gain.setTargetAtTime(0,o.current.currentTime,.2))},[a,n]),l.useEffect(()=>{m.current=null},[s]),null};function Ht(){const{currentSystem:n}=z();return l.useCallback(()=>{const s=document.querySelector("canvas");if(s)try{const a=n==="doublePendulum"?"pendulum":n,o=new Date().toISOString().split("T")[0],r=`chaos-lab-${a}-${o}.png`;s.toBlob(i=>{if(!i)return;const h=URL.createObjectURL(i),u=document.createElement("a");u.href=h,u.download=r,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(h)},"image/png")}catch(a){console.warn("Screenshot failed:",a)}},[n])}const Gt=new Set(["lorenz","rossler","doublePendulum"]),Vt=new Set(["classic","neon","blueprint","terminal"]);function ze(){const n=z.getState(),t=new URLSearchParams;switch(t.set("sys",n.currentSystem),t.set("theme",n.colorTheme),t.set("speed",n.speed.toFixed(1)),t.set("trail",String(n.trailLength)),t.set("sbs",n.sideBySideMode?"1":"0"),n.sideBySideMode&&t.set("offset",n.initialOffset.toExponential(1)),n.bloomEnabled&&t.set("bloom",n.bloomIntensity.toFixed(1)),n.audioEnabled&&t.set("audio","1"),n.currentSystem){case"lorenz":t.set("sigma",n.lorenzParams.sigma.toFixed(2)),t.set("rho",n.lorenzParams.rho.toFixed(2)),t.set("beta",n.lorenzParams.beta.toFixed(3));break;case"rossler":t.set("a",n.rosslerParams.a.toFixed(3)),t.set("b",n.rosslerParams.b.toFixed(3)),t.set("c",n.rosslerParams.c.toFixed(2));break;case"doublePendulum":t.set("m1",n.doublePendulumParams.mass1.toFixed(2)),t.set("m2",n.doublePendulumParams.mass2.toFixed(2)),t.set("l1",n.doublePendulumParams.length1.toFixed(2)),t.set("l2",n.doublePendulumParams.length2.toFixed(2)),t.set("g",n.doublePendulumParams.gravity.toFixed(2)),t.set("damp",n.doublePendulumParams.damping.toFixed(3));break}return"#"+t.toString()}function Ut(n){if(!n||n.length<2)return!1;try{const t=new URLSearchParams(n.slice(1)),s=z.getState(),a=t.get("sys");if(a&&Gt.has(a))s.setCurrentSystem(a);else return!1;const o=t.get("theme");o&&Vt.has(o)&&s.setColorTheme(o);const r=parseFloat(t.get("speed")||"");r>0&&r<=5&&s.setSpeed(r);const i=parseInt(t.get("trail")||"");if(i>=100&&i<=5e3&&s.setTrailLength(i),t.get("sbs")==="1"){s.setSideBySideMode(!0);const c=parseFloat(t.get("offset")||"");c>0&&c<1&&s.setInitialOffset(c)}const u=parseFloat(t.get("bloom")||"");switch(u>0&&u<=4?(s.setBloomEnabled(!0),s.setBloomIntensity(u)):t.has("bloom")&&t.get("bloom")==="0"&&s.setBloomEnabled(!1),t.get("audio")==="1"&&s.setAudioEnabled(!0),a){case"lorenz":{const c=parseFloat(t.get("sigma")||""),p=parseFloat(t.get("rho")||""),m=parseFloat(t.get("beta")||"");c>0&&s.setLorenzParams({sigma:c}),p>0&&s.setLorenzParams({rho:p}),m>0&&s.setLorenzParams({beta:m});break}case"rossler":{const c=parseFloat(t.get("a")||""),p=parseFloat(t.get("b")||""),m=parseFloat(t.get("c")||"");c>0&&s.setRosslerParams({a:c}),p>0&&s.setRosslerParams({b:p}),m>0&&s.setRosslerParams({c:m});break}case"doublePendulum":{const c=parseFloat(t.get("m1")||""),p=parseFloat(t.get("m2")||""),m=parseFloat(t.get("l1")||""),f=parseFloat(t.get("l2")||""),d=parseFloat(t.get("g")||""),g=parseFloat(t.get("damp")||"");c>0&&s.setDoublePendulumParams({mass1:c}),p>0&&s.setDoublePendulumParams({mass2:p}),m>0&&s.setDoublePendulumParams({length1:m}),f>0&&s.setDoublePendulumParams({length2:f}),d>0&&s.setDoublePendulumParams({gravity:d}),g>=0&&s.setDoublePendulumParams({damping:g});break}}return!0}catch{return!1}}function Ne(){return window.location.origin+window.location.pathname+ze()}function Wt(){const n=l.useRef(!1);l.useEffect(()=>{n.current||(n.current=!0,window.location.hash&&Ut(window.location.hash))},[]);const{currentSystem:t,colorTheme:s,speed:a,trailLength:o,sideBySideMode:r,initialOffset:i,lorenzParams:h,rosslerParams:u,doublePendulumParams:c,bloomEnabled:p,bloomIntensity:m,audioEnabled:f}=z();l.useEffect(()=>{const d=setTimeout(()=>{window.history.replaceState(null,"",ze())},500);return()=>clearTimeout(d)},[t,s,a,o,r,i,h,u,c,p,m,f])}const pe=["classic","neon","blueprint","terminal"],fe=["lorenz","rossler","doublePendulum"];function Yt(n){const t=Ht();l.useEffect(()=>{const s=a=>{const o=a.target.tagName;if(o==="INPUT"||o==="TEXTAREA"||o==="SELECT"||a.ctrlKey||a.metaKey||a.altKey)return;const r=z.getState();switch(a.key){case" ":a.preventDefault(),r.setIsPlaying(!r.isPlaying);break;case"r":case"R":r.resetSimulation();break;case"1":r.setCurrentSystem(fe[0]),r.setCurrentPreset(null);break;case"2":r.setCurrentSystem(fe[1]),r.setCurrentPreset(null);break;case"3":r.setCurrentSystem(fe[2]),r.setCurrentPreset(null);break;case"s":case"S":r.setSideBySideMode(!r.sideBySideMode),r.sideBySideMode||r.resetSimulation();break;case"t":case"T":{const i=pe.indexOf(r.colorTheme),h=pe[(i+1)%pe.length];r.setColorTheme(h);break}case"h":case"H":case"?":n();break;case"p":case"P":t();break;case"l":case"L":try{navigator.clipboard.writeText(Ne())}catch{window.prompt("Share this URL:",Ne())}break;case"c":case"C":r.setCinematicCamera(!r.cinematicCamera);break;case"a":case"A":r.setChaosAutopilot(!r.chaosAutopilot);break;case"m":case"M":r.setAudioEnabled(!r.audioEnabled);break;case"b":case"B":r.setBloomEnabled(!r.bloomEnabled);break;case"Escape":r.storyMode?(r.setStoryMode(!1),r.setCinematicCamera(!1)):r.showBifurcation?r.setShowBifurcation(!1):r.showPoincare?r.setShowPoincare(!1):r.showParameterSpace?r.setShowParameterSpace(!1):r.cinematicCamera&&r.setCinematicCamera(!1);break}};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[n,t])}const Kt=l.lazy(()=>ge(()=>import("./BifurcationDiagram-BwwQLxQF.js"),__vite__mapDeps([0,1,2])).then(n=>({default:n.BifurcationDiagram}))),Xt=l.lazy(()=>ge(()=>import("./PoincareSection-CcWwMgsW.js"),__vite__mapDeps([3,1,4])).then(n=>({default:n.PoincareSection}))),Zt=l.lazy(()=>ge(()=>import("./ParameterSpace-BtBtlbfb.js"),__vite__mapDeps([5,1,6])).then(n=>({default:n.ParameterSpace})));function Jt(){const n=z(t=>t.setIsPlaying);l.useEffect(()=>{const t=window.matchMedia("(prefers-reduced-motion: reduce)");t.matches&&n(!1);const s=a=>{a.matches&&n(!1)};return t.addEventListener("change",s),()=>t.removeEventListener("change",s)},[n])}function Qt(){const{colorTheme:n,currentSystem:t}=z(),s=I[n],[a,o]=l.useState(!1),[r,i]=l.useState(!1),[h,u]=l.useState(!0),[c,p]=l.useState(!1),m=l.useRef(t),[f,d]=l.useState(!1),g=l.useCallback(()=>o(x=>!x),[]);Jt(),Yt(g),Wt(),l.useEffect(()=>{const x=setTimeout(()=>i(!0),100),y=setTimeout(()=>p(!0),1200),P=setTimeout(()=>u(!1),6e3);return()=>{clearTimeout(x),clearTimeout(y),clearTimeout(P)}},[]),l.useEffect(()=>{if(m.current!==t){d(!0);const x=setTimeout(()=>d(!1),600);return m.current=t,()=>clearTimeout(x)}},[t]);const R=t==="lorenz"?"Lorenz Attractor":t==="rossler"?"RÃ¶ssler Attractor":"Double Pendulum";return e.jsxs("div",{className:`app ${r?"entered":"entering"} ${f?"system-transitioning":""}`,style:{"--bg":s.bg,"--text":s.text,"--accent":s.accent},children:[e.jsx("a",{href:"#controls-region",className:"skip-link",children:"Skip to controls"}),e.jsxs("div",{className:"sr-only",role:"status","aria-live":"polite","aria-atomic":"true",children:["Now viewing: ",R]}),e.jsx("main",{className:f?"scene-crossfade":"",children:e.jsx(Ct,{})}),e.jsxs("div",{className:`ui-layer ${c?"visible":""}`,children:[e.jsx(Lt,{}),e.jsx("div",{id:"controls-region",children:e.jsx(Nt,{})}),e.jsx(It,{}),e.jsx(Bt,{}),e.jsxs(l.Suspense,{fallback:null,children:[e.jsx(Kt,{}),e.jsx(Xt,{}),e.jsx(Zt,{})]})]}),e.jsx(Ot,{isVisible:a,onClose:g}),e.jsx($t,{}),e.jsx(Ft,{}),e.jsx(qt,{}),e.jsxs("div",{className:`title-overlay ${h?"visible":"faded"}`,"aria-hidden":"true",onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),children:[e.jsx("h1",{children:"Chaos Lab"}),e.jsx("p",{children:"Interactive Chaos Theory Visualizer"})]}),e.jsx("div",{className:`instructions ${c?"visible":""}`,"aria-hidden":"true",children:e.jsx("p",{children:"Drag to explore Â· Scroll to dive deeper Â· Right-drag to drift"})})]})}Je.createRoot(document.getElementById("root")).render(e.jsx(l.StrictMode,{children:e.jsx(Qt,{})}));export{I as T,G as s,z as u};
